# Story 2.2: Product Matrix with Ordering System

## Status
Ready for Review

## Story
**As a** покупатель,
**I want** видеть три варианта ретрознаков с ценами и легко заказать нужный,
**so that** я могу быстро выбрать подходящий продукт и оформить заявку.

## Acceptance Criteria
1. Создана товарная матрица с тремя продуктами через CSS Grid (Обычный 1990₽, Петроградский 4300₽, Ленинградский 9300₽)
2. Под каждым товаром размещены HTML кнопки "Заказать [модель]"
3. Реализована HTML форма заказа с полями: имя, телефон, комментарий и встроенной валидацией
4. Настроена отправка данных на PHP backend через vanilla JavaScript с указанием выбранной модели
5. Добавлены уведомления успеха/ошибки через vanilla JavaScript без использования внешних библиотек

## Tasks / Subtasks

- [x] Создать товарную матрицу с тремя продуктами (AC: 1)
  - [x] Реализовать CSS Grid layout для product-grid
  - [x] Создать product-card компоненты для каждой модели
  - [x] Добавить Schema.org микроданные для товаров
  - [x] Настроить featured карточку для популярного товара
  - [x] Добавить изображения товаров в SVG формате (placeholder)

- [x] Добавить кнопки заказа под каждым товаром (AC: 2)
  - [x] Создать btn-order кнопки с data-атрибутами
  - [x] Реализовать привязку модели и цены через dataset
  - [x] Добавить aria-label для accessibility

- [x] Реализовать HTML форму заказа (AC: 3)
  - [x] Создать форму с семантическими полями
  - [x] Добавить встроенную HTML5 валидацию
  - [x] Настроить form-input стили для полей
  - [x] Добавить поле выбора модели ретрознака
  - [x] Интегрировать SmartCaptcha для защиты от спама

- [x] Настроить отправку данных на PHP backend (AC: 4)
  - [x] Реализовать ProductSelector класс в JavaScript
  - [x] Создать FormHandler для отправки данных
  - [x] Настроить отправку FormData на /php/send-form.php
  - [x] Передавать выбранную модель в форму заказа

- [x] Добавить уведомления успеха/ошибки (AC: 5)
  - [x] Реализовать showSuccessMessage() в FormHandler
  - [x] Добавить showErrorMessage() для обработки ошибок
  - [x] Создать стили для success-message и error-message
  - [x] Настроить автоматическое скрытие уведомлений

- [x] Интеграция компонентов и тестирование
  - [x] Подключить модули в app.js
  - [x] Протестировать выбор товара и переход к форме
  - [x] Проверить отправку данных и получение ответа
  - [x] Протестировать валидацию полей формы

## Dev Notes

### Архитектурная информация

**Технический стек** [Source: architecture/html5.md, architecture/css.md, architecture/javascript.md]:
- HTML5 с семантической разметкой и Schema.org микроданными
- CSS3 с компонентной архитектурой + Tailwind CSS через CDN
- Vanilla JavaScript ES6+ с модульной архитектурой
- PHP backend для обработки форм (send-form.php)

**CSS Grid Layout для товарной матрицы** [Source: architecture/css.md]:
```css
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  max-width: 1200px;
  margin: 0 auto;
}

/* Responsive breakpoints */
@media (min-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .product-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}
```

**Компонентная архитектура CSS** [Source: architecture/css.md]:
- `.product-card` - основной компонент карточки товара
- `.product-card--featured` - модификатор для популярного товара
- `.btn-primary` - стили кнопок заказа
- `.form-container` - контейнер формы заказа
- `.form-input` - стили полей ввода

**JavaScript модульная архитектура** [Source: architecture/javascript.md]:
- `ProductSelector` класс для выбора товаров
- `FormHandler` класс для обработки формы заказа
- Инициализация через `app.js` основной файл
- ES6+ модули с import/export

**Schema.org микроданные для товаров** [Source: architecture/html5.md]:
```html
<article class="product-card" itemscope itemtype="https://schema.org/Product">
  <meta itemprop="name" content="Петроградский ретрознак">
  <meta itemprop="price" content="4300">
  <meta itemprop="priceCurrency" content="RUB">
</article>
```

**PHP Backend интеграция** [Source: php/send-form.php]:
- Обработка FormData через POST запрос на `/php/send-form.php`
- Валидация полей: phone (обязательно), model (обязательно)
- SmartCaptcha интеграция для защиты от спама
- Отправка email на настроенные адреса из .env файла
- JSON ответ с success/error статусом

**Товарная матрица - три модели** [Source: docs/3-content-wireframe.md]:

1. **Обычный ретрознак**: 1990₽
   - Сталь 1 мм, плоский дизайн
   - Порошковая покраска + УФ-печать
   - Защита полимерной эмалью
   - Размер 47×35 см, БЕЗ подсветки
   - Гарантия 3 года

2. **Петроградский ретрознак**: 4300₽ (популярный выбор)
   - Сталь 0,7 мм, матовые стекла
   - Полимерная покраска, матовые стекла
   - Фирменное клеймо «РЗ»
   - Размер 47×34 см, БЕЗ подсветки
   - Гарантия 3 года

3. **Ленинградский ретрознак**: 9300₽ (максимальное качество)
   - Нержавеющая сталь 0,8 мм
   - Полимерная покраска + полимерная эмаль
   - LED подсветка (5 Вт), провод 1,5 м
   - Размер 52×40 см — как в оригинале 1950-х
   - ПОЖИЗНЕННАЯ гарантия на корпус
   - Идеально для приморских районов

**Responsive дизайн** [Source: architecture/responsive-design-strategy.md]:
- Mobile-first подход с breakpoints
- Touch-friendly кнопки минимум 44px × 44px
- Grid адаптация под разные экраны

**Файловая структура проекта**:
- HTML: `index.html` (основной файл)
- CSS: `assets/css/main.css`, `assets/css/components.css`
- JS: `assets/js/app.js`, `assets/js/modules/`
- PHP: `php/send-form.php`
- Images: `assets/images/products/` (WebP формат)

### Testing

**Тестирование функциональности**:
- Ручное тестирование выбора товаров и переходов
- Проверка валидации формы в разных браузерах
- Тестирование отправки данных на PHP backend
- Проверка responsive верстки на разных устройствах
- Тестирование accessibility (screen readers, keyboard navigation)

**Критерии готовности**:
- Все три товара отображаются корректно в grid layout
- Кнопки заказа работают и передают данные в форму
- Форма валидируется и отправляет данные на backend
- Показываются уведомления об успехе/ошибке
- Responsive дизайн работает на всех breakpoints

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-15 | 1.0 | Создание черновика истории 2.2 | Bob (Scrum Master) |
| 2025-01-15 | 1.1 | Исправление товарной матрицы согласно контентному вайрфрейму | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References

Все логи разработки доступны в консоли браузера при разработке на localhost:8000

### Completion Notes List

1. **Товарная матрица создана** - Реализована полная HTML-разметка с CSS Grid Layout для трех продуктов
2. **Schema.org микроданные добавлены** - Каждый продукт имеет корректные метаданные для SEO
3. **JavaScript модули обновлены** - ProductSelector адаптирован под новые data-атрибуты
4. **PHP backend обновлен** - Валидация моделей приведена в соответствие с новыми значениями форм
5. **Изображения продуктов созданы** - SVG placeholder'ы для всех трех моделей ретрознаков
6. **Форма заказа готова** - HTML5 валидация, семантические поля, accessibility поддержка
7. **Интеграция завершена** - Все компоненты успешно работают вместе

### File List

#### Созданные файлы:
- `images/products/obyichnyiy-retroznak.svg` - Изображение для Обычного ретрознака
- `images/products/petrogradskiy-retroznak.svg` - Изображение для Петроградского ретрознака
- `images/products/leningradskiy-retroznak.svg` - Изображение для Ленинградского ретрознака
- `images/products/placeholder.svg` - Базовый placeholder для продуктов

#### Измененные файлы:
- `index.html` - Добавлена товарная матрица с тремя продуктами, обновлена форма заказа
- `js/modules/product-selector.js` - Обновлены данные продуктов и логика извлечения моделей
- `php/send-form.php` - Обновлена валидация моделей для соответствия новым data-значениям
- `docs/stories/2.2.story.md` - Обновлен статус и отмечены выполненные задачи

## QA Results

*Результаты QA-тестирования будут добавлены после завершения разработки*